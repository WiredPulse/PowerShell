# NOTE: The user you use to query Excahnge with must have the Discovery Management RBAC Role.

# Add a user to the Discovery Management RBAC Role
Add-RoleGroupMember "discovery management" -member [some_user]

<#
Searches for emails with attachments named "document1" and "document2", regardless of the file extension. For any hits, a log file containing metadata about the message (user, 
read status, sent date/time, etc.) will be saved to a folder called "Search_Nov13" within the "ftomlinson" mailbox.
#>
Get-Mailbox | Search-Mailbox -SearchQuery 'Attachment:"document1.*" or "document2.*"' -TargetMailbox "ftomlinson" -TargetFolder "Search_Nov13" -LogLevel Full 

#This modification will search for all “.doc” and “.pdf” files and copy them to the same mailbox and folder
Get-Mailbox | Search-Mailbox -SearchQuery 'Attachment:"*.doc" or "*.pdf"' -TargetMailbox "ftomlinson" -TargetFolder "Search_Nov13" -LogLevel Full 

#This modification will search for all “.doc” and “.pdf” files and copy them to the same mailbox and folder
Get-Mailbox | Search-Mailbox -SearchQuery 'Attachment:"*.doc" or "*.pdf"' -TargetMailbox "ftomlinson" -TargetFolder "Search_Nov13" -LogLevel Full 



#To search for keywords use this modification.
Get-Mailbox | Search-Mailbox -SearchQuery "badword1" or "badword2" -TargetMailbox "ftomlinson" -TargetFolder "Search_Nov13" -LogLevel Full 

